###### Basic app settings
NODE_ENV=production
LISTEN_HOST=0.0.0.0
LISTEN_PORT=8080
# BASE_PATH=
LOG_LEVEL=warn
# Force application timezone (affects pretty logs)
TZ=UTC

###### Database
DATABASE_URL=postgresql://media_user:changeme@localhost:5432/media_storage

###### S3 Storage (Garage)
S3_ENDPOINT=http://localhost:3900
S3_REGION=garage
S3_ACCESS_KEY_ID=your_access_key
S3_SECRET_ACCESS_KEY=your_secret_key
S3_BUCKET=media-files
S3_FORCE_PATH_STYLE=true

###### File Upload Limits
MAX_FILE_SIZE_MB=100
BLOCK_EXECUTABLE_UPLOADS=true
BLOCK_ARCHIVE_UPLOADS=true

###### EXIF Extraction
# Max size in megabytes for EXIF extraction (default 25MB)
# Set to 0 to disable EXIF extraction
EXIF_MAX_BYTES_MB=25
# Legacy fallback (bytes) is still supported if EXIF_MAX_BYTES is set
# EXIF_MAX_BYTES=26214400

###### Image Compression (Upload)
# Force compression for all uploads (ignores optimize parameter in request)
FORCE_IMAGE_COMPRESSION_ENABLED=false

# Compression modes:
# - FORCE_IMAGE_COMPRESSION_ENABLED=true: request compression params are ignored, settings below are used.
# - FORCE_IMAGE_COMPRESSION_ENABLED=false: compression is applied only when request includes "optimize" params.
#   In this mode, settings below act as defaults/limits (e.g. maxDimension is capped).

# Format used by default (webp or avif)
IMAGE_COMPRESSION_FORMAT=webp
# Max dimensions
IMAGE_COMPRESSION_MAX_DIMENSION=3840
# Strip metadata (EXIF/ICC/XMP) during compression
IMAGE_COMPRESSION_STRIP_METADATA=false
# Enable lossless compression
IMAGE_COMPRESSION_LOSSLESS=false
# Shared quality/effort settings for both WebP and AVIF.
# Format-specific knobs are intentionally not exposed because the output format is not expected
# to change frequently. If needed, legacy variables are still supported as a fallback.
IMAGE_COMPRESSION_QUALITY=80
IMAGE_COMPRESSION_EFFORT=6
IMAGE_COMPRESSION_AVIF_CHROMA_SUBSAMPLING=4:4:4

###### Thumbnails
THUMBNAIL_FORMAT=webp
THUMBNAIL_MAX_DIMENSION=2048
THUMBNAIL_MAX_AGE_DAYS=90
# Thumbnail quality and effort (applied to selected format)
THUMBNAIL_QUALITY=80
THUMBNAIL_EFFORT=6

###### Heavy Tasks Queue
# Maximum concurrent heavy tasks (EXIF extraction, thumbnails, compression)
# Adjust based on available CPU cores and memory
HEAVY_TASKS_MAX_CONCURRENCY=4
# Timeout for heavy tasks in milliseconds
HEAVY_TASKS_QUEUE_TIMEOUT_MS=30000

###### Cleanup Job
CLEANUP_ENABLED=true
CLEANUP_CRON=0 */6 * * *
# TTL for files with bad status (uploading/deleting/failed/missing)
CLEANUP_BAD_STATUS_TTL_DAYS=7
# Batch size for cleanup operations
CLEANUP_BATCH_SIZE=200
# TTL for unused thumbnails is controlled by THUMBNAIL_MAX_AGE_DAYS